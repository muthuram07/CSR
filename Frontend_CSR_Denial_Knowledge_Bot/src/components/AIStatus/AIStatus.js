import React, { useState, useEffect } from 'react';\nimport { getEnabledServices, getServiceDisplayName, getServiceLimits } from '../../config/aiServices';\nimport advancedAI from '../../services/advancedAI';\nimport './AIStatus.css';\n\nfunction AIStatus() {\n  const [servicesStatus, setServicesStatus] = useState({});\n  const [isTesting, setIsTesting] = useState(false);\n  const [testResults, setTestResults] = useState({});\n\n  useEffect(() => {\n    checkServicesStatus();\n  }, []);\n\n  const checkServicesStatus = () => {\n    const enabled = getEnabledServices();\n    const status = {};\n    \n    enabled.forEach(service => {\n      status[service] = {\n        name: getServiceDisplayName(service),\n        status: 'configured',\n        limits: getServiceLimits(service)\n      };\n    });\n    \n    setServicesStatus(status);\n  };\n\n  const testAllServices = async () => {\n    setIsTesting(true);\n    setTestResults({});\n    \n    try {\n      const results = await advancedAI.testServices();\n      setTestResults(results);\n      \n      // Update status based on test results\n      const updatedStatus = { ...servicesStatus };\n      Object.entries(results).forEach(([service, result]) => {\n        if (updatedStatus[service]) {\n          updatedStatus[service].status = result.status;\n          updatedStatus[service].error = result.error;\n        }\n      });\n      \n      setServicesStatus(updatedStatus);\n    } catch (error) {\n      console.error('Error testing services:', error);\n    } finally {\n      setIsTesting(false);\n    }\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'working': return '#10b981';\n      case 'failed': return '#ef4444';\n      case 'error': return '#f59e0b';\n      case 'not_configured': return '#6b7280';\n      default: return '#3b82f6';\n    }\n  };\n\n  const getStatusIcon = (status) => {\n    switch (status) {\n      case 'working': return '‚úÖ';\n      case 'failed': return '‚ùå';\n      case 'error': return '‚ö†Ô∏è';\n      case 'not_configured': return '‚öôÔ∏è';\n      default: return 'üîÑ';\n    }\n  };\n\n  return (\n    <div className=\"ai-status-container\">\n      <div className=\"ai-status-header\">\n        <h3>ü§ñ AI Services Status</h3>\n        <button \n          onClick={testAllServices} \n          disabled={isTesting}\n          className=\"test-all-btn\"\n        >\n          {isTesting ? 'Testing...' : 'Test All Services'}\n        </button>\n      </div>\n\n      <div className=\"services-grid\">\n        {Object.entries(servicesStatus).map(([service, status]) => (\n          <div key={service} className=\"service-card\">\n            <div className=\"service-header\">\n              <div className=\"service-info\">\n                <span className=\"service-name\">{status.name}</span>\n                <span className=\"service-key\">{service.toUpperCase()}</span>\n              </div>\n              <div \n                className=\"service-status\"\n                style={{ color: getStatusColor(status.status) }}\n              >\n                <span className=\"status-icon\">{getStatusIcon(status.status)}</span>\n                <span className=\"status-text\">{status.status.replace('_', ' ').toUpperCase()}</span>\n              </div>\n            </div>\n\n            {status.limits && (\n              <div className=\"service-limits\">\n                <h4>Free Tier Limits:</h4>\n                <div className=\"limits-grid\">\n                  <div className=\"limit-item\">\n                    <span className=\"limit-label\">Requests/Min:</span>\n                    <span className=\"limit-value\">{status.limits.requests_per_minute || 'N/A'}</span>\n                  </div>\n                  <div className=\"limit-item\">\n                    <span className=\"limit-label\">Tokens/Min:</span>\n                    <span className=\"limit-value\">{status.limits.tokens_per_minute || 'N/A'}</span>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {testResults[service] && (\n              <div className=\"test-result\">\n                <div className=\"test-header\">\n                  <span>Test Result:</span>\n                  <span className={`test-status ${testResults[service].status}`}>\n                    {getStatusIcon(testResults[service].status)}\n                  </span>\n                </div>\n                {testResults[service].error && (\n                  <div className=\"test-error\">\n                    <strong>Error:</strong> {testResults[service].error}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n\n      {Object.keys(servicesStatus).length === 0 && (\n        <div className=\"no-services\">\n          <div className=\"no-services-icon\">‚öôÔ∏è</div>\n          <h3>No AI Services Configured</h3>\n          <p>To enable advanced AI capabilities, add API keys to your environment variables:</p>\n          <div className=\"setup-instructions\">\n            <h4>Quick Setup:</h4>\n            <ol>\n              <li>Get free API keys from providers</li>\n              <li>Add to your environment variables</li>\n              <li>Restart the application</li>\n            </ol>\n            \n            <div className=\"api-keys-help\">\n              <h5>Free API Key Sources:</h5>\n              <ul>\n                <li><strong>OpenAI:</strong> platform.openai.com (Free $5 credit)</li>\n                <li><strong>Google Gemini:</strong> ai.google.dev (Completely free)</li>\n                <li><strong>Groq:</strong> console.groq.com (Free tier)</li>\n                <li><strong>Anthropic:</strong> console.anthropic.com (Free tier)</li>\n                <li><strong>Hugging Face:</strong> huggingface.co (Free tier)</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"ai-status-footer\">\n        <div className=\"usage-tips\">\n          <h4>üí° Usage Tips:</h4>\n          <ul>\n            <li>Complex questions automatically use advanced AI</li>\n            <li>Services fallback automatically if one fails</li>\n            <li>Free tiers have rate limits</li>\n            <li>Configure multiple services for reliability</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AIStatus;
